<app-page-title [template]="'trade-result'"></app-page-title>
<app-message [message]="message"></app-message>
<app-loading [loading]="loading" [containerHeight]="15" [imageHeight]="5"></app-loading>

<div *ngIf="!loading && tradeResult" class="mt-content">

<div class="summary">
	<p><b>Trade:</b> {{tradeResult.tradeName}}</p>
	<p><b>Total of Items:</b> {{tradeResult.totalOfItems}}</p>
	<p><b>Total of Traded Items:</b> {{tradeResult.totalOfTradedItems}}</p>
	<p><b>Total of Items not Traded:</b> {{tradeResult.totalOfNotTradedItems}}</p>
</div>

<div *ngIf="tradeResult.totalOfTradedItems > 0" class="filter-tab is-pulled-right">
	<div class="filter-tab-icon">
		<i class="fas fa-filter" aria-hidden="true"></i>
	</div>
	<div class="select is-small">
		<select id="filter-select" #filterSelect (change)="filter(filterSelect.value)">
			<option value="my-entries">My Entries</option>
			<option value="all-entries">All Entries</option>
		</select>
	</div>
</div>

<table *ngIf="tradeResult.totalOfTradedItems > 0" class="table mt-table-hoverable is-hoverable is-striped is-fullwidth">
	<tr *ngFor="let tradedItem of tradeResult.tradedItems">
		<td (click)="toogleExpanded(tradedItem)">
			<div>
				<span>{{tradedItem.userName}}</span>
				<span class="is-pulled-right expanding-icon">
					<i *ngIf="!tradedItem.expanded" class="fas fa-angle-double-down"></i>
					<i *ngIf="tradedItem.expanded" class="fas fa-angle-double-up"></i>
				</span>
			</div>
			<div *ngIf="tradedItem.expanded" class="expanded-traded-item">
				<b>Sends:</b> {{tradedItem.itemName}}<br>
				<b>To:</b> {{tradedItem.sendingUserName}}<br>
				<b>And receives: </b> {{tradedItem.receivingItemName}}<br>
				<b>From:</b> {{tradedItem.receivingUserName}}<br>
			</div>
		</td>
	</tr>
</table>

<div class="mt-cmd-panel-container">
    <button
    class="mt-cmd-panel-first button is-primary"
    type="button"
    (click)="navigateBack()">
    <i class="fa fa-backward" aria-hidden="true"></i>Back
  </button>
  <button
    class="mt-cmd-panel-first button is-primary"
    type="button"
    (click)="download()">
    <i class="fa fa-download" aria-hidden="true"></i>Download as CSV
  </button>
</div>

</div>